<!DOCTYPE HTML>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Highlight similar points</title>

    <style type="text/css">
        textarea {
            width: 80%;
            height: 300px;
        }
    </style>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
    <script src="js/highcharts/highcharts.js"></script>
    <script src="js/highcharts/modules/exporting.js"></script>
    <script src="js/highcharts/modules/export-data.js"></script>
    <!-- <script src="js/highcharts/modules/xAxis-zero-crossing.js"></script> -->
    <script src="js/themes/sdv_highchartstheme.js"></script>
</head>

<body>
    <h1>Demo met highlighten overeenklomstige data punten</h1>
    <p>Op <a href="https://www.volksgezondheidenzorg.info/ranglijst/ranglijst-ziekten-op-basis-van-sterfte/geslacht">VZinfo.nl</a> staan ranglijsten in tabel vorm met bijvoorbeeld sterfte cijfers van mannen en vrouwen.
      Er is een wens om die tabellen ook te visualiseren door in een grafiek met data punten voor beide geslachten de overeenkomstige data punten
      te highlighten bij mouseover (of click).
      <br/>
      Dit is een eerste aanzet.
    </p>

    <p>
      In de theme file is de functie gedefiniÃ«erd <strong>syncHighlight</strong> 
      die bij bijvoorbeeld een muis event van een datapunt alle overeenkomstige datapunten op zoekt en highlight.
      <br/>
      De functie wordt in de theme file gekoppeld aan de mouseover/mouseOut events van de plotOptions.series.point 
    </p>
    <pre>
      point: {
        events: {
          mouseOver: syncHighlight,
          mouseOut: syncHighlight 
        }
      }
    </pre>
   
    <h2>Ranglijst sterfte</h2>
    <div id="htmlwidget-1"></div>
    <!-- script with json source is not loaded automically? -->
    <script type="application/json" src="chart-config/Ranglijst-Sterfte.json" data-for="htmlwidget-1"></script>
    <script type="application/json" data-for="htmlwidget-2">
        {
          "chart":{"type":"bar","renderTo":{}},
          "colors":["rgba(0,80,149,0.4)","rgba(248,120,96,0.6)","#c00027","#c00027","#c00027","#c0c0c0"],
          "title":{"text":"Top 10 sterfte 2017 voor vrouwen en mannen"},
          "xAxis":{"visible":false, "categories":[1,2,3,4,5],"labels":{"step":1},"reversed":true},
          "yAxis":{"opposite": true, "title":{"text":"Aantal sterfgevallen"},"labels":{},"allowDecimals":false, 
                  "min": -12000, "max": 12000, "tickInterval":2000},
          "tooltip":{},
          "legend": {"enabled": true},
          "plotOptions": {
            "bar": {
              "groupPadding":0,
              "borderWidth":0.5,
              "grouping":false
            }
          },
          "series":[
            { 
              "id":"Vrouwen","name":"vrouwen",
              "data":[
                {"y": -10719, "name": "Dementie"},
                {"y": -5421, "name": "Beroerte"},
                {"y": -4509, "name": "Hartfalen"},
                {"y": -4257, "name": "Longkanker"},
                {"y": -3363, "name": "COPD"},
                {"y": -3350, "name": "Coronaire hartziekten"},
                {"y": -3106, "name": "Borstkanker"},
                {"y": -2408, "name": "Accidentele val"},
                {"y": -2326, "name": "Dikkedarmkanker"},
                {"y": -2085, "name": "Infecties van de onderste luchtwegen"}
              ],
              "pointPadding":0.05,"showInLegend":true,"_colorIndex":1
            }, 
            {
              "id":"Mannen","name":"mannen",
              "data":[
                {"y": 6134, "name": "Longkanker"},
                {"y": 5259, "name": "Dementie"},
                {"y": 4983, "name": "Coronaire hartziekten"},
                {"y": 3935, "name": "Beroerte"},
                {"y": 3759, "name": "COPD"}, 
                {"y": 3180, "name": "Hartfalen"},
                {"y": 2862, "name": "Prostaatkanker"},
                {"y": 2771, "name": "Dikkedarmkanker"},
                {"y": 1684, "name": "Infecties van de onderste luchtwegen"},
                {"y": 1623, "name": "Accidentele val"}
              ],
              "pointPadding":0.05,"showInLegend":true,"_colorIndex":0
            }]
          }
    </script>


    <script type="text/javascript">

        function renderRCharts() {
            /* Rendering all R Charts by looping all htmlwidget containers, 
            |  find correspondig R-config object (script.json) and render chart 
            
            */
            $('div[id|="htmlwidget"').each(function (index, value) {
              var container = this;
              var id = $(this).attr('id');
              var scriptTag = $('script[data-for="' + id + '"');
              var strConfig = '', objConfig = {}, hcConfig = {};

              console.log('div' + index + ':' + id);
              
              // download json if src attribute is present, otherwise use text content of script tag
              if( scriptTag.attr('src') != undefined ){
                $.getJSON( scriptTag.attr('src'), function( objConfig ) {
                  if(objConfig.x != undefined){
                    hcConfig = objConfig.x.hc_opts;
                    hcConfig = objRConfig.x.hc_opts;
                  } else {
                      hcConfig = objConfig;
                  }
                  Highcharts.chart(id, hcConfig);
                });
              } else {
                strConfig = scriptTag.text();
                objConfig = JSON.parse(strConfig);

                console.log(objConfig);
                if(objConfig.x != undefined){
                    hcConfig = objConfig.x.hc_opts;
                    hcConfig = objRConfig.x.hc_opts;
                } else {
                    hcConfig = objConfig;
                }
                
                Highcharts.chart(id, hcConfig);
              }
              
              
            });
        }

        renderRCharts();
    </script>
</body>

</html>